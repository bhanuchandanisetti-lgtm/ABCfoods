<!DOCTYPE html>
<html>
<head>
  <title>Review Order - ABC Sea Foods</title>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-light p-4">

<div class="container">
  <div class="card shadow">
    <div class="card-body">
      <h4 class="mb-3">Order Review</h4>

      {% if cart|length == 0 %}
        <div class="alert alert-info">No items in cart.</div>
        <a class="btn btn-secondary" href="{{ url_for('dashboard') }}">Back</a>
      {% else %}
        
      <table class="table align-middle">
          <thead>
            <tr>
              <th>Product</th>
              <th class="text-end">Qty</th>
              <th class="text-end">Unit Price (₹)</th>
              <th class="text-end">Line Total (₹)</th>
              <th class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
          {% for item in cart %}
            <tr>
              <td>{{ item.name }}</td>

              <!-- Quantity edit form -->
              <td class="text-end">
                <form method="POST" action="{{ url_for('cart_update_item') }}" class="d-flex justify-content-end">
                  <input type="hidden" name="product_id" value="{{ item.product_id }}">
                  <input type="number"
                        name="qty"
                        min="0"
                        value="{{ item.qty }}"
                        class="form-control form-control-sm text-end"
                        style="width:70px;">
                  <button class="btn btn-sm btn-primary ms-2" type="submit">
                    Update
                  </button>
                </form>
              </td>

              <td class="text-end">{{ "%.2f"|format(item.unit_price) }}</td>
              <td class="text-end">{{ "%.2f"|format(item.line_total) }}</td>

              <!-- Remove item form -->
              <td class="text-end">
                <form method="POST" action="{{ url_for('cart_remove_item') }}">
                  <input type="hidden" name="product_id" value="{{ item.product_id }}">
                  <button class="btn btn-sm btn-danger" type="submit">
                    Remove
                  </button>
                </form>
              </td>
            </tr>
          {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <th colspan="3" class="text-end">Order Total</th>
              <th class="text-end">₹{{ "%.2f"|format(cart_total) }}</th>
              <th></th>
            </tr>
          </tfoot>
        </table>


        <form method="POST" action="{{ url_for('order_confirm') }}">
          <button class="btn btn-success" type="submit">Confirm Order</button>
          <a class="btn btn-secondary" href="{{ url_for('dashboard') }}">Back / Edit</a>
        </form>
      {% endif %}
    </div>
  </div>
</div>

</body>
</html>
